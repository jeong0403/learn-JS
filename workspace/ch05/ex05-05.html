<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div id="todo">
      <header>
        <h1>Todo List - ëª©ë¡ ì¡°íšŒ ğŸ™‚</h1>
      </header>
      <div id="main">
        <div id="container">
          <ul>
            <li>
              <h2>ì‡¼í•‘ ëª©ë¡</h2>
              <!-- ìƒˆë¡œìš´ í• ì¼ ì…ë ¥ í¼ -->
              <div class="todoinput">
                <input type="text" autofocus onkeyup="handleKeyup(event)" />
                <button type="button" onclick="handleAdd()">ì¶”ê°€</button>
              </div>
              <!-- í• ì¼ ëª©ë¡ì´ í‘œì‹œë˜ëŠ” ì˜ì—­ -->
              <ul class="todolist">
                <!-- <li data-no="1"> // htmlì€ ì–˜ë¥¼ ì½ì§€ ëª»í•¨
                  <span>1</span>
                  <span><s>ìƒ˜í”Œ1</s></span>
                  <button type="button">ì‚­ì œ</button>
                </li>
                <li data-no="2">
                  <span>2</span>
                  <span>ìƒ˜í”Œ2</span>
                  <button type="button">ì‚­ì œ</button>
                </li>
                <li data-no="3">
                  <span>3</span>
                  <span>ìƒ˜í”Œ3</span>
                  <button type="button">ì‚­ì œ</button>
                </li> -->
              </ul>
            </li>
          </ul>
        </div>
      </div>
      <footer>
        <p>ë©‹ìŸì´ ì‚¬ìì²˜ëŸ¼ FrontEnd BootCamp</p>
      </footer>
    </div>

    <script>
      /**
       * í•œ ê±´ì˜ Todo ê°ì²´ë¥¼ ë°›ì•„ì„œ, DOM ìš”ì†Œë¡œ ìƒì„±í•´ ë°˜í™˜í•©ë‹ˆë‹¤.
       * @param {Object} item - Todo í•­ëª© ê°ì²´
       * @param {number} item.no - ê³ ìœ  ë²ˆí˜¸
       * @param {string} item.title - í•  ì¼ ì œëª©
       * @param {boolean} item.done - ì™„ë£Œ ì—¬ë¶€
       * @returns {HTMLElement} ìƒì„±ëœ <li> DOM ìš”ì†Œ
       */
      function getTodoItemElem(item) {
        // item -> { no: 3, title: 'ë¼ë©´', done: true } Todo ê°ì²´
        // ìë°”ìŠ¤í¬ë¦½íŠ¸ ê°ì²´ (ìœ„ item) ë°›ì•„ì„œ todo ê°ì²´ë¥¼ ë°˜í™˜í• ê±°ì•¼
        /* ë°˜í™˜í•  DOM ê°ì²´
        return  <li>
          <span>3</span>
          <span>ìƒ˜í”Œ3</span>
          <button type="button">ì‚­ì œ</button>
        </li>
        */
        // <li>
        const liElem = document.createElement("li");
        // <span>
        const noElem = document.createElement("span");
        // <span>
        const titleElem = document.createElement("span");
        // <button>
        const deleteElem = document.createElement("button");

        //ğŸ“Œ í…ìŠ¤íŠ¸ ìƒì„±
        // 3
        const noTxt = document.createTextNode(item.no);
        // ìƒ˜í”Œ 3
        const titleTxt = document.createTextNode(item.title);
        // ì‚­ì œ
        const deleteTxt = document.createTextNode("ì‚­ì œ");

        // ì¡°ë¦½
        // <span>3</span>
        noElem.appendChild(noTxt);
        // <span>ìƒ˜í”Œ3</span>
        titleElem.appendChild(titleTxt);
        // <button type="button">ì‚­ì œ</button>
        deleteElem.setAttribute("type", "button"); // typeìœ¼ë¡œ button ê°’ì„ ì¶”ê°€í•´ë¼!
        titleElem.setAttribute("tabindex", 0); // ì™„ë£Œ/ë¯¸ì™„ë£Œ ì²˜ë¦¬ë¥¼ ìœ„í•œ íƒ­ í¬ì»¤ì‹± (í¬ì»¤ì„œë¸” ê°ì²´ - ì ‘ê·¼ì„±) ë’¤ì— '0'ìœ¼ë¡œ ë”°ì˜´í‘œ ë¶™ì—¬ë„ ë¨
        deleteElem.appendChild(deleteTxt);

        // liì˜ ìì‹ìœ¼ë¡œ ì¡°ë¦½
        // <li><span>3</span></li>
        liElem.appendChild(noElem);
        // <li><span>3</span><span tabindex = "0">ìƒ˜í”Œ3</span></li>
        liElem.appendChild(titleElem);
        // <li><span>3</span><span tabindex = "0">ìƒ˜í”Œ3</span><button type="button">ì‚­ì œ</button></li>
        liElem.appendChild(deleteElem);

        // custom ì†ì„±
        // ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë¹„í‘œì¤€ í˜•íƒœì˜ ì†ì„±ì„ ë¶€ì—¬í•´ë„ êº¼ë‚¼ ìˆ˜ëŠ” ìˆìŒ. data-* ë¶™ì—¬ì£¼ë©´ ë¨
        // <li data-no = "3"> // ì†Œë–¡ì¼€ì´ìŠ¤ data - no ì‚¬ì´ì— ë¼ìš´ë‹¤
        // elem.dataset.no -> 3 // data-*ë¥¼ ì°¾ì•„ì„œ dataset ì•ˆì— ìë™ìœ¼ë¡œ ê°€ì ¸ì˜´ (data-ë¡œ ì‹œì‘í•˜ëŠ” ì‚¬ìš©ì ì •ì˜ ì†ì„±ì„ ë‹´ì€ ì „ìš© ê´€ë¦¬ ê°ì²´)
        liElem.dataset.no = item.no; // datasetë§Œ ì“°ë©´ 'ì†ì„±ë“¤ì˜ ë¬¶ìŒ'ì¼ ë¿. ê·¸ë˜ì„œ .noë¥¼ ë¶™ì—¬ì„œ data ê°ì²´ ë‚´ì˜ noë¥¼ ê°€ì ¸ì™€ë¼ê³  í•  ìˆ˜ ìˆìŒ.
        // li ìš”ì†Œì— data-no ì†ì„±ì„ ë‹¬ê³ , ê·¸ ê°’ì€ item ì•ˆì— ìˆëŠ” no ê°’ì„ ì¨
        // liElem.setAttribute("data-no", item.no);
        liElem.dataset.done = item.done;

        // "ì‚­ì œ" ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€
        // ì´ë²¤íŠ¸ë°©ë²•(1) : DOM Level2
        deleteElem.addEventListener("click", function (event) {
          // eventê°€ ë°œìƒí–ˆì„ ë•Œ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜
          // noë¥¼ ì°¾ì•„ì„œ~~~ ì²« ë²ˆì§¸ ë°©ë²•
          const btn = event.target; // í´ë¦­ ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ ìš”ì†Œ (<button>)
          // btnì˜ ì¡°ìƒ ì¤‘ ì…€ë ‰í„°ì™€ ì¼ì¹˜í•˜ëŠ” ê°€ì¥ ê°€ê¹Œìš´ ì¡°ìƒì„ ì°¾ì„ ë•Œ ì“°ëŠ” ê²ƒ â‡’ closest
          const liNode = btn.closest("li"); // <li data-no = '3'>
          deleteItem(liNode.dataset.no); // li ìš”ì†Œì˜ data-no ì†ì„±ê°’ì„ ê°€ì ¸ì˜´
        });

        // ì´ë²¤íŠ¸ë°©ë²•(2) : DOM Level0
        // ì‚­ì œ ì´ë²¤íŠ¸ ë“±ë¡
        deleteElem.setAttribute("onclick", `deleteItem(${item.no})`); // deleteItem í•¨ìˆ˜ => ì´ê±° í˜¸ì¶œ
        // í˜¸ì¶œí•˜ëŠ” í˜•íƒœ: deleteItem(${item.no});

        // ì™„ë£Œ/ë¯¸ì™„ë£Œ ì²˜ë¦¬ (ì´ë²¤íŠ¸ ë°©ë²• 1ë¡œ ì²˜ë¦¬)
        titleElem.addEventListener("click", function (event) {
          // eventê°€ ë°œìƒí–ˆì„ ë•Œ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜
          // noë¥¼ ì°¾ì•„ì„œ~~~ ì²« ë²ˆì§¸ ë°©ë²•
          const btn = event.target; // í´ë¦­ ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ ìš”ì†Œ (<button>)
          // btnì˜ ì¡°ìƒ ì¤‘ ì…€ë ‰í„°ì™€ ì¼ì¹˜í•˜ëŠ” ê°€ì¥ ê°€ê¹Œìš´ ì¡°ìƒì„ ì°¾ì„ ë•Œ ì“°ëŠ” ê²ƒ â‡’ closest
          const liNode = btn.closest("li"); // <li data-no = '3'>
          toggleDone(liNode.dataset.no); // // li ìš”ì†Œì˜ data-no ì†ì„±ê°’ì„ ê°€ì ¸ì˜´
        });

        // ì™„ë£Œ/ë¯¸ì™„ë£Œ ì²˜ë¦¬ (ì´ë²¤íŠ¸ ë°©ë²• 2ë¡œ ì²˜ë¦¬)
        // titleElem.setAttribute("onclick", `toggleDone(${item.no})`); // toggleDone í•¨ìˆ˜ => ì´ê±° í˜¸ì¶œ

        // ì•„ë˜ ë‚´ìš©ì„ innerHTMLì— ë„£ì–´ë„ ë¨ --> í•˜ì§€ë§Œ ì§€ê¸ˆ ì—°ìŠµí•˜ëŠ” ë‹¨ê³„ë¼ ê°€ì¥ ê¸°ë³¸ì ì¸ ë°©ë²•ìœ¼ë¡œ ì§„í–‰í•¨
        // <li>
        // <span>3</span>
        // <span>ìƒ˜í”Œ3</span>
        // <button type="button">ì‚­ì œ</button>
        // </li>
        return liElem;
      }

      /*
      â‡’í•¨ìˆ˜ í˜¸ì¶œ ìˆœì„œ
      1. ì¶”ê°€ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ handleAdd() ì‹¤í–‰
      2. handleAdd()ê°€ addItem() í˜¸ì¶œ
      3. addItem()ì´ getTodoItemElem() í˜¸ì¶œ
      4. getTodoItemElem()ì—ì„œ return liElem í–ˆìœ¼ë¯€ë¡œ ë‹¤ì‹œ addItem() í˜¸ì¶œ
      5. ëª¨ë‘ í˜¸ì¶œ í›„ì— console.logì— ì¶œë ¥ì´ ë˜ë©´ì„œ liì— ì¶”ê°€ ëœë‹¤!
      6. ì´í›„ í•¨ìˆ˜ê°€ ëë‚˜ë©´ ìŒ“ì—¬ìˆë˜ Call Stackì˜ ë°ì´í„°ê°€ ëª¨ë‘ ì‚¬ë¼ì§„ë‹¤.
      */

      /**
       * ì¶”ê°€ ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰ë˜ëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
       * ì…ë ¥ì°½ì˜ ê°’ì„ ê°€ì ¸ì™€ ìƒˆë¡œìš´ Todo ì•„ì´í…œì„ ì¶”ê°€
       */
      function handleAdd() {
        const inputElem = document.querySelector(".todoinput > input");
        if (inputElem.value.trim() !== "") {
          // ë¹ˆ ë¬¸ìì¼ë•Œ ì¶”ê°€ ì•ˆë˜ë„ë¡ ë§‰ìŒ
          addItem(inputElem.value.trim()); //<input>, <select> ê°™ì€ í¼ì˜ ì…ë ¥ ìš”ì†Œì—ëŠ” valueì†ì„±ìœ¼ë¡œ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì„ íƒí•œ ê°’ì´ ì €ì¥ë˜ì–´ ìˆìŒ
          inputElem.value = "";
          inputElem.focus(); // ì¶”ê°€ë²„íŠ¼ì„ ëˆ„ë¥´ê³  ë‚˜ë©´ ì›ë˜ ì»¤ì„œê°€ ë²„íŠ¼ì— ê°€ìˆëŠ”ë° ë‹¤ì‹œ ì¸í’‹ìœ¼ë¡œ ì˜®ê²¨ë¼.
        }
      }

      /**
       * ì…ë ¥ì°½ì—ì„œ í‚¤ë³´ë“œ ì…ë ¥ ì‹œ ì‹¤í–‰ë˜ëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
       * Enter í‚¤ ì…ë ¥ ì‹œ ì¶”ê°€ ê¸°ëŠ¥ ì‹¤í–‰
       * @param {KeyboardEvent} event - í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ê°ì²´
       */
      function handleKeyup(event) {
        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆëŠ” Event ê°ì²´
        if (event.key === "Enter") {
          handleAdd();
        }
      }

      // let itemNo = 3;

      /**
       * ìƒˆë¡œìš´ Todo ì•„ì´í…œì„ ëª©ë¡ì— ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
       * @param {string} title - ì¶”ê°€í•  í•  ì¼ì˜ ì œëª©
       */
      function addItem(title) {
        const todoList = document.querySelector(".todolist");

        const item = {
          // childeren: ìš”ì†Œë…¸ë“œì¸ ìì‹ë…¸ë“œì˜ ëª©ë¡(ìš”ì†Œë…¸ë“œë§Œ) <-> childëŠ” í…ìŠ¤íŠ¸ ë…¸ë“œ, ì£¼ì„ ë…¸ë“œ, ê³µë°±..ë“± ê¹Œì§€ë„ í¬í•¨
          no: todoList.children.length + 1,
          // no: document.querySelectorAll('.todolist > li').length + 1,
          // no: ++itemNo,
          // title: title, // ì†ì„±ê°’ì„ ë‹´ëŠ” ë³€ìˆ˜ê°€ ì†ì„±ëª…ê³¼ ì¼ì¹˜í•  ê²½ìš° ì†ì„±ê°’ ìƒëµ ê°€ëŠ¥
          title,
          done: false, // ë¯¸ì™„ë£Œ ìƒíƒœ
        };
        const todoLi = getTodoItemElem(item); // ì™¼ìª½ì€ ë³€ìˆ˜ = ì˜¤ë¥¸ìª½ì€ í•¨ìˆ˜ í˜¸ì¶œ -> ìœ„ë¡œ ì˜¬ë¼ê°€ì„œ itemì„ ì°¾ì•„
        console.log(todoLi);

        todoList.appendChild(todoLi);
      }

      /**
       * ë§Œì•½ì— ìˆ˜ë™ìœ¼ë¡œ í•˜ë©´ htmlì—ì„œ ì·¨ì†Œì„ ì„ ì¶”ê°€ í•´ì¤˜ì•¼ í•¨.
       * Todo ì•„ì´í…œì˜ ì™„ë£Œ/ë¯¸ì™„ë£Œ ìƒíƒœë¥¼ í† ê¸€í•˜ëŠ” í•¨ìˆ˜ (ì™„ë£Œ â†” ë¯¸ì™„ë£Œ)
       * @param {number} no - í† ê¸€í•  í•  ì¼ì˜ ê³ ìœ  ë²ˆí˜¸
       */
      // ìˆ˜ì—… ì‹œê°„ ì½”ë“œ
      function toggleDone(no) {
        /*
        <li data0no = "3" data-done = "true">
        <span>3</span>
        <span>ìƒ˜í”Œ3</span> // ì´ê²Œ ì§€ê¸ˆ span:last-of-type
        <button type="button">ì‚­ì œ</button>
        </li>
        */
        const targetLi = document.querySelector(`.todolist > li[data-no="${no}"]`);
        const done = targetLi.dataset.done === 'true';
        console.log(typeof done, done); // í˜„ì¬ falseë¼ì„œ ì½˜ì†”ì— string falseë¼ê³  ì°í˜
        const titleEl = targetLi.querySelector('span:last-of-type'); // <span>ìƒ˜í”Œ3</span> li ìš”ì†Œ ë…¸ë“œ ì•ˆì—ì„œ ë§ˆì§€ë§‰ span ì°¾ì„ê²Œ
        if (done) { // doneì´ trueë¼ë©´ <span><s>ìƒ˜í”Œ3</s></span> -> <span>ìƒ˜í”Œ3</span> ë¯¸ì™„ë£Œë¡œ ìˆ˜ì •
          titleEl.appendChild(titleEl.firstChild.firstChild);
          titleEl.firstChild.remove();
        } else { // doneì´ flaseë¼ë©´ <span>ìƒ˜í”Œ3</span> ë¯¸ì™„ë£Œ ìƒíƒœ -> <span><s>ìƒ˜í”Œ3</s></span> ì™„ë£Œë¡œ ìˆ˜ì •
          const sElem = document.createElement('s'); // <s>  
          sElem.appendChild(titleEl.firstChild); // <s>ìƒ˜í”Œ3</s> titleElì˜ ì²« ë²ˆì§¸ ìì‹ìœ¼ë¡œ <s> ì¶”ê°€
          titleEl.appendChild(sElem); // <span><s>ìƒ˜í”Œ3</s></span>
        }
        targetLi.dataset.done = !done; // ì™„ë£Œ ì—¬ë¶€ë¥¼ í† ê¸€ (li ìš”ì†Œì˜ data-done ì†ì„±ê°’ì„ ë°˜ì „ì‹œí‚´ t<->f)
      }

      // ì§ì ‘ ì‘ì„±í•œ ì½”ë“œ - í† ê¸€
      // function toggleDone(no) {
      //   // todolistì˜ í•˜ìœ„ì˜ data-no ì†ì„±ê³¼ ì¼ì¹˜í•˜ëŠ” li ìš”ì†Œ ì°¾ê¸°
      //   const targetLi = document.querySelector(
      //     `.todolist > li[data-no="${no}"]`
      //   );
      //   // ìœ„ì—ì„œ ì°¾ì€ liì˜ ë‘ ë²ˆì§¸ span ì„ íƒ
      //   const titleSpan = targetLi.querySelectorAll("span")[1];
      //   // <span> ì•ˆì— <s> íƒœê·¸ í™•ì¸ -> ì·¨ì†Œì„  íŒë‹¨
      //   // titleSpanì— <s> ìˆìœ¼ë©´ ìš”ì†Œ ê°€ì ¸ì˜¤ê³ , ì—†ìœ¼ë©´ null ë°˜í™˜
      //   const strikeIn = titleSpan.querySelector("s");

      //   if (strikeIn) {
      //     // ë§Œì•½ ì·¨ì†Œì„ ì´ ìˆìœ¼ë©´ <span> ì•ˆì— <s> ìˆìŒ
      //     titleSpan.textContent = strikeIn.textContent; // <s>ë‚´ìš©</s> í…ìŠ¤íŠ¸ ì¶”ì¶œ í›„ <span>ë‚´ìš©</span>ìœ¼ë¡œ ë°”ê¾¼ë‹¤ = <s> ì œê±°
      //   } else {
      //     // ì·¨ì†Œì„  ì—†ìœ¼ë©´ <s>ë¡œ ê°ì‹¸ê¸°
      //     titleSpan.innerHTML = `<s>${titleSpan.textContent}</s>`;
      //   }
      // }

      /**
       * Todo ì•„ì´í…œì„ ì‚­ì œí•˜ëŠ” í•¨ìˆ˜
       * @param {number} no - ì‚­ì œí•  í•  ì¼ì˜ ê³ ìœ  ë²ˆí˜¸
       */
      function deleteItem(no) {
        //(no)ëŠ” í•¨ìˆ˜ ì•ˆì—ì„œ noë¼ëŠ” ë³€ìˆ˜ë¥¼ í˜¸ì¶œí• ê±°ì•¼! ë¼ëŠ” ì˜ë¯¸ì„
        const targetLi = document.querySelector(
          `.todolist > li[data-no="${no}"]`
        );
        targetLi.remove();
      }
    </script>
  </body>
</html>
